
% y^2=x^3+ax+b
% p= 8542D69E 4C044F18 E8B92435 BF6FF7DE 45728391 5C45517D 722EDB8B 08F1DFC3
% a='787968B4 FA32C3FD 2417842E 73BBFEFF 2F3C848B 6831D7E0 EC65228B 3937E498';
% b= 63E4C6D3 B23B0C84 9CF84241 484BFE48 F61D59A5 B16BA06E 6E12D1DA 27C5249A
%%%%%%%  G基点
% x='421DEBD6 1B62EAB6 746434EB C3CC315E 32220B3B ADD50BDC 4C4E6C14 7FEDD43D';
% y='0680512B CBB42C07 D47349D2 153B70C4 E5D7FDFC BFA36EA1 A85841B9 E46E09A2';
N='8542D69E4C044F18E8B92435BF6FF7DD297720630485628D5AE74EE7C32E79B7';

da='128B2FA8BD433C6C068C8D803DFF79792A519A55171B1B650C23661D15897263';
%Pa(Xa,Ya)  Xa='0AE4C779 8AA0F119 471BEE11 825BE462 02BB79E2 A5844495 E97C04FF 4DF2548A';
%           Ya='7C0240F8 8F1CD4E1 6352A73C 17B7F16F 07353E53 A176D684 A9FE0C6B B798E857';        

xa='0AE4C7798AA0F119471BEE11825BE46202BB79E2A5844495E97C04FF4DF2548A';
ya='7C0240F88F1CD4E16352A73C17B7F16F07353E53A176D684A9FE0C6BB798E857';  
%k='6CB28D99 385C175C 94F94E93 4817663F C176D925 DD72B727 260DBAAE 1FB2F96F';


x='421DEBD61B62EAB6746434EBC3CC315E32220B3BADD50BDC4C4E6C147FEDD43D';
y='0680512BCBB42C07D47349D2153B70C4E5D7FDFCBFA36EA1A85841B9E46E09A2';
z='0000000000000000000000000000000000000000000000000000000000000001';
M='F4A38489E32B45B6F876E3AC2168CA392362DC8F23459C1D1146FC3DBFB7BC9A6D65737361676520646967657374';

k='6CB28D99385C175C94F94E934817663FC176D925DD72B727260DBAAE1FB2F96F';

e=hash(M);

[x1,y1]=k_point(k,x,y);
% XX='110FCDA57615705D5E7B9324AC4B856D23E6D9188B2AE47759514657CE25D112';

OO=data_reduce(e,N);
OX=data_add(OO,x1);
r=data_reduce(OX(2:65),N);     
% r=r1(2:65);

OP=data_add(da,'0000000000000000000000000000000000000000000000000000000000000001');
dA=mod_inv(OP(2:65),2);        %%%%%%%%模N

SS=montgomery_mul_N(da,r);
SD=mod_reduce_N(k,SS);
s=montgomery_mul_N(dA,SD);


t=mod_add_N(r,s);

[x0,y0]=k_point(s,x,y);
[x00,y00]=k_point(t,xa,ya);
[x_1,y_1]=pointadd(x0,y0,'0000000000000000000000000000000000000000000000000000000000000001',x00,y00,'0000000000000000000000000000000000000000000000000000000000000001');

R=data_add(e,x_1);
































