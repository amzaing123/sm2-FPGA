% pointadd
function [X,Y,Z] = pointadd(x,y,z,x1,y1,z1)
% y^2=x^3+ax+b
% p= 8542D69E 4C044F18 E8B92435 BF6FF7DE 45728391 5C45517D 722EDB8B 08F1DFC3
% a='787968B4 FA32C3FD 2417842E 73BBFEFF 2F3C848B 6831D7E0 EC65228B 3937E498';
% b= 63E4C6D3 B23B0C84 9CF84241 484BFE48 F61D59A5 B16BA06E 6E12D1DA 27C5249A
%%%%%%%  G基点
% x='421DEBD6 1B62EAB6 746434EB C3CC315E 32220B3B ADD50BDC 4C4E6C14 7FEDD43D';
% y='0680512B CBB42C07 D47349D2 153B70C4 E5D7FDFC BFA36EA1 A85841B9 E46E09A2';
% 
% x='6fd0c22ba3e7002903661d4fe437712dffed5598de92e89700d8e9689b5e9d25';
% y='820b194e3b128ce51668bbb05ddc007fa6174495cdae5bd7719a58b161a3e58e';
% z='045350d422b9cb8a10456db6d2f7b6b2ac80f8aa1179e19d92e89c0fede35faf';
% % 
% x='421DEBD61B62EAB6746434EBC3CC315E32220B3BADD50BDC4C4E6C147FEDD43D';
% y='0680512BCBB42C07D47349D2153B70C4E5D7FDFCBFA36EA1A85841B9E46E09A2';
% z='0000000000000000000000000000000000000000000000000000000000000001';
% x1='04D1DF516231EE428870804D3D5B6993C917DCCEC26D0E1ACCACBCC4624EE423';
% y1='138EBF710F5D32D4694A5C6EC68E29C27562E9CB48144E31F2568C5063BB248A';
% z1='0D00A2579768580FA8E693A42A76E189CBAFFBF97F46DD4350B08373C8DC1344';
% x='4D05091A19FAEA32BEC8084F243A6657BE29169C8FB4F55387A724F0A0CBB043';
% y='3B7F674C03EDA18AE70A95B2B3C60E3ADD93A87DF1B60DD4AE4C06319E76E408';
% z='0B45888101688A6F5A61BFACEAADE6D3413BDC9F1AE0F2964FB8CE88D21DF436';
% x1 ='03aeabc2f6f3b5621032393625b2f4f18ecba9c30d9fc95ed1c9fe0803b7d7ef';
% y1 ='029fff86c2a09202253831ded4c4234d4a17e2acb8b455c2e2c468564849d0a3';
% z1 ='32ed08b3214caee7e1a99372eb8a616311a638f09d455c4acff96df90e9611c7';
% 7DEACE5FD121BC385A3C6317249F413D28C17291A60DFD83B835A45392D22B0A2E49D5E5279E5FA91E71FD8F693A64A3C4A9461115A4FC9D79F34EDC8BDDEBD0
% x='7DEACE5FD121BC385A3C6317249F413D28C17291A60DFD83B835A45392D22B0A';
% y='2E49D5E5279E5FA91E71FD8F693A64A3C4A9461115A4FC9D79F34EDC8BDDEBD0';
% z='0000000000000000000000000000000000000000000000000000000000000001';
% % 1657FA75BF2ADCDC3C1F6CF05AB7B45E04D3ACBE8E4085CFA669CB2564F17A9F19F0115F21E16D2F5C3A485F8575A128BBCDDF80296A62F6AC2EB842DD058E50
% x1='1657FA75BF2ADCDC3C1F6CF05AB7B45E04D3ACBE8E4085CFA669CB2564F17A9F';
% y1='19F0115F21E16D2F5C3A485F8575A128BBCDDF80296A62F6AC2EB842DD058E50';
% z1='0000000000000000000000000000000000000000000000000000000000000001';
% x='7049fad0b15bf8370c5ecb1946ed72b2c307f20868c9ee80e470087bbfdabf42';
% y='4417c289540201260c356bd2142f59bc7afc84ce202b43dd6e968b660aed48e9';
% z='126582f56440eb12b74e8601421f4be9c40e491ae57034171fea24cf23c79e94';
% 
% x1 ='04D1DF516231EE428870804D3D5B6993C917DCCEC26D0E1ACCACBCC4624EE423';
% y1 ='138EBF710F5D32D4694A5C6EC68E29C27562E9CB48144E31F2568C5063BB248A';
% z1 ='0D00A2579768580FA8E693A42A76E189CBAFFBF97F46DD4350B08373C8DC1344';


% x1='49cff7a6a0c8920da6361737ffd14ced70005ba36dec2cdb8a823cf62ebb0a6d';
% y1='1dad5abb46e7cb6b12ff4997b5ddb8efee3d686a53b3707ebd8bec51111ceb02';
% z1='3d04169fe8d2631927195d1ccf0359b0e43c26817861e8615d216d9cfcffac15';
% % 
% x ='1103f2e5383602341da5bece990c77910ab3be41ba81968be0738f430f9aba8b';
% y ='31efa9ba68d22888cc2cf7ab949f44b8a8a600f696f54e7d1230ac30c39b1b10';
% z ='51e8b213f645ae061e0799d949bdbb438928a78219f2b279ffef800429d2ecaa';

% x='6AA69CBC15BA952A3D2A7F0F8E7F2A171BFB17FF5C454800EB439773FB382A03';
% y='353B054DCAC1DE5306FD701F4328F3C4BE93946008B8A018C54CD208308BCCD8';
% a='787968B4FA32C3FD2417842E73BBFEFF2F3C848B6831D7E0EC65228B3937E498';

A1=montgomery_mul(z1,z1);
A=montgomery_mul(x,A1);

B1=montgomery_mul(z,z);
B=montgomery_mul(x1,B1);


C=mod_reduce(A,B);

D1=montgomery_mul(z1,z1);
D2=montgomery_mul(D1,z1);
D=montgomery_mul(y,D2);

E1=montgomery_mul(z,z);
E2=montgomery_mul(E1,z);
E=montgomery_mul(y1,E2);

F=mod_reduce(D,E);
G=mod_add(A,B);
H=mod_add(D,E);

X1=montgomery_mul(F,F);
X2=montgomery_mul(C,C);
X3=montgomery_mul(G,X2);
X=mod_reduce(X1,X3);

I1=montgomery_mul('0000000000000000000000000000000000000000000000000000000000000002',X);
I=mod_reduce(X3,I1);

Z1=montgomery_mul(z,z1);
Z=montgomery_mul(Z1,C);

Y1=montgomery_mul(F,I);
Y2=montgomery_mul(C,C);
Y3=montgomery_mul(Y2,C);
Y4=montgomery_mul(H,Y3);
Y5=mod_reduce(Y1,Y4);
Y=montgomery_mul(Y5,'42A16B4F2602278C745C921ADFB7FBEF22B941C8AE22A8BEB9176DC58478EFE2'); %%%%  y=((FI-HC^3)/2)modp=(FI-HC^3)modp*(1/2)modp,其中（1/2）modp可以通过预计算得出为一个定值。


% Z2=mod_inv(Z,1);
% 
% Z3=montgomery_mul(Z2,Z2);
% Z4=montgomery_mul(Z3,Z2);
% 
% XX=montgomery_mul(X,Z3);
% YY=montgomery_mul(Y,Z4);



















