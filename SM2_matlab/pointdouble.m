% pointdouble
function [X,Y,Z] = pointdouble(x,y,z)
% y^2=x^3+ax+b
% p= 8542D69E 4C044F18 E8B92435 BF6FF7DE 45728391 5C45517D 722EDB8B 08F1DFC3
% a1='787968B4 FA32C3FD 2417842E 73BBFEFF 2F3C848B 6831D7E0 EC65228B 3937E498';
% b= 63E4C6D3 B23B0C84 9CF84241 484BFE48 F61D59A5 B16BA06E 6E12D1DA 27C5249A
%%%%%%%  G基点
% x='421DEBD6 1B62EAB6 746434EB C3CC315E 32220B3B ADD50BDC 4C4E6C14 7FEDD43D';
% y='0680512B CBB42C07 D47349D2 153B70C4 E5D7FDFC BFA36EA1 A85841B9 E46E09A2';

% x='421DEBD61B62EAB6746434EBC3CC315E32220B3BADD50BDC4C4E6C147FEDD43D';
% y='0680512BCBB42C07D47349D2153B70C4E5D7FDFCBFA36EA1A85841B9E46E09A2';
% z='0000000000000000000000000000000000000000000000000000000000000001';
% x='04D1DF516231EE428870804D3D5B6993C917DCCEC26D0E1ACCACBCC4624EE423';
% y='138EBF710F5D32D4694A5C6EC68E29C27562E9CB48144E31F2568C5063BB248A';
% z='0D00A2579768580FA8E693A42A76E189CBAFFBF97F46DD4350B08373C8DC1344';
a1='787968B4FA32C3FD2417842E73BBFEFF2F3C848B6831D7E0EC65228B3937E498';
A1=montgomery_mul(x,x);
A2=montgomery_mul(A1,'0000000000000000000000000000000000000000000000000000000000000003');
A3=montgomery_mul(z,z);
A4=montgomery_mul(A3,A3);
A5=montgomery_mul(a1,A4);
A=mod_add(A2,A5);

B1=montgomery_mul('0000000000000000000000000000000000000000000000000000000000000004',x);
B2=montgomery_mul(y,y);
B=montgomery_mul(B1,B2);

C1=montgomery_mul(y,y);
C2=montgomery_mul(C1,C1);
C=montgomery_mul('0000000000000000000000000000000000000000000000000000000000000008',C2);

x1=montgomery_mul(A,A);
x2=montgomery_mul('0000000000000000000000000000000000000000000000000000000000000002',B);
X=mod_reduce(x1,x2);

y1=mod_reduce(B,X);
y2=montgomery_mul(A,y1);
Y=mod_reduce(y2,C);

z1=montgomery_mul(y,z);
Z=montgomery_mul('0000000000000000000000000000000000000000000000000000000000000002',z1);



% Z2=mod_inv(Z,1);
% 
% Z3=montgomery_mul(Z2,Z2);
% Z4=montgomery_mul(Z3,Z2);
% 
% XX=montgomery_mul(X,Z3);
% YY=montgomery_mul(Y,Z4);

















